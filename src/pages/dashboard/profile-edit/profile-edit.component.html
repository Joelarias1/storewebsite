<div class="p-4 bg-gray-900 text-white min-h-screen">
  <div class="max-w-4xl mx-auto">
    <!-- Título y navegación -->
    <div class="mb-6">
      <h1 class="text-2xl font-bold text-white mb-2">Editar Perfil</h1>
      <div class="flex space-x-1 text-sm text-gray-400">
        <a routerLink="/dashboard" class="hover:text-blue-400">Dashboard</a>
        <span>/</span>
        <a routerLink="/dashboard/profile" class="hover:text-blue-400">Perfil</a>
        <span>/</span>
        <span class="text-gray-300">Editar</span>
      </div>
    </div>

    <!-- Alertas -->
    <div *ngIf="successMessage" class="mb-6 p-4 rounded-lg bg-green-600/20 text-green-400 border border-green-700">
      <div class="flex items-center">
        <i class="fa fa-check-circle mr-2"></i>
        <span>{{ successMessage }}</span>
      </div>
    </div>

    <div *ngIf="errorMessage" class="mb-6 p-4 rounded-lg bg-red-600/20 text-red-400 border border-red-700">
      <div class="flex items-center">
        <i class="fa fa-exclamation-circle mr-2"></i>
        <span>{{ errorMessage }}</span>
      </div>
    </div>

    <!-- Pestañas de navegación -->
    <div class="border-b border-gray-700 mb-6">
      <nav class="flex space-x-8">
        <button 
          (click)="setEditMode('profile')" 
          class="py-4 px-1 font-medium transition-colors relative"
          [ngClass]="editMode === 'profile' ? 'text-blue-400' : 'text-gray-400 hover:text-gray-200'">
          Información de Perfil
          <span *ngIf="editMode === 'profile'" class="absolute bottom-0 left-0 w-full h-0.5 bg-blue-400"></span>
        </button>
        <button 
          (click)="setEditMode('password')" 
          class="py-4 px-1 font-medium transition-colors relative"
          [ngClass]="editMode === 'password' ? 'text-blue-400' : 'text-gray-400 hover:text-gray-200'">
          Cambiar Contraseña
          <span *ngIf="editMode === 'password'" class="absolute bottom-0 left-0 w-full h-0.5 bg-blue-400"></span>
        </button>
        <button 
          (click)="setEditMode('avatar')" 
          class="py-4 px-1 font-medium transition-colors relative"
          [ngClass]="editMode === 'avatar' ? 'text-blue-400' : 'text-gray-400 hover:text-gray-200'">
          Foto de Perfil
          <span *ngIf="editMode === 'avatar'" class="absolute bottom-0 left-0 w-full h-0.5 bg-blue-400"></span>
        </button>
      </nav>
    </div>

    <!-- Formulario de edición de perfil -->
    <div *ngIf="editMode === 'profile'" class="bg-gray-800 rounded-xl shadow-lg border border-gray-700 p-6">
      <form [formGroup]="profileForm" (ngSubmit)="saveProfile()">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <div>
            <label for="fullName" class="block text-sm font-medium text-gray-300 mb-1">Nombre Completo</label>
            <input 
              type="text" 
              id="fullName" 
              formControlName="fullName"
              class="w-full px-4 py-2 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            <div *ngIf="profileForm.get('fullName')?.invalid && profileForm.get('fullName')?.touched" class="text-red-400 text-sm mt-1">
              <span *ngIf="profileForm.get('fullName')?.errors?.['required']">El nombre es obligatorio</span>
              <span *ngIf="profileForm.get('fullName')?.errors?.['minlength']">El nombre debe tener al menos 3 caracteres</span>
            </div>
          </div>

          <div>
            <label for="username" class="block text-sm font-medium text-gray-300 mb-1">Nombre de Usuario</label>
            <input 
              type="text" 
              id="username" 
              formControlName="username"
              class="w-full px-4 py-2 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            <div *ngIf="profileForm.get('username')?.invalid && profileForm.get('username')?.touched" class="text-red-400 text-sm mt-1">
              <span *ngIf="profileForm.get('username')?.errors?.['required']">El nombre de usuario es obligatorio</span>
              <span *ngIf="profileForm.get('username')?.errors?.['minlength']">El nombre de usuario debe tener al menos 3 caracteres</span>
              <span *ngIf="profileForm.get('username')?.errors?.['pattern']">Solo letras, números, guiones y guiones bajos</span>
            </div>
          </div>

          <div>
            <label for="email" class="block text-sm font-medium text-gray-300 mb-1">Email</label>
            <input 
              type="email" 
              id="email" 
              formControlName="email"
              class="w-full px-4 py-2 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            <div *ngIf="profileForm.get('email')?.invalid && profileForm.get('email')?.touched" class="text-red-400 text-sm mt-1">
              <span *ngIf="profileForm.get('email')?.errors?.['required']">El email es obligatorio</span>
              <span *ngIf="profileForm.get('email')?.errors?.['email']">Email no válido</span>
            </div>
          </div>

          <div>
            <label for="location" class="block text-sm font-medium text-gray-300 mb-1">Ubicación</label>
            <input 
              type="text" 
              id="location" 
              formControlName="location"
              class="w-full px-4 py-2 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
          </div>
        </div>

        <div class="mb-6">
          <label for="bio" class="block text-sm font-medium text-gray-300 mb-1">Biografía</label>
          <textarea 
            id="bio" 
            formControlName="bio"
            rows="4"
            class="w-full px-4 py-2 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
          <div *ngIf="profileForm.get('bio')?.invalid && profileForm.get('bio')?.touched" class="text-red-400 text-sm mt-1">
            <span *ngIf="profileForm.get('bio')?.errors?.['maxlength']">La biografía no puede exceder 500 caracteres</span>
          </div>
        </div>

        <div class="mb-6">
          <label for="website" class="block text-sm font-medium text-gray-300 mb-1">Sitio Web</label>
          <input 
            type="text" 
            id="website" 
            formControlName="website"
            placeholder="https://ejemplo.com"
            class="w-full px-4 py-2 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
          <div *ngIf="profileForm.get('website')?.invalid && profileForm.get('website')?.touched" class="text-red-400 text-sm mt-1">
            <span *ngIf="profileForm.get('website')?.errors?.['pattern']">URL no válida</span>
          </div>
        </div>

        <div formGroupName="social" class="mb-8">
          <h3 class="text-lg font-medium text-gray-200 mb-3">Redes Sociales</h3>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div>
              <label for="twitter" class="block text-sm font-medium text-gray-300 mb-1">Twitter</label>
              <div class="flex">
                <span class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-600 bg-gray-700 text-gray-400">&#64;</span>
                <input 
                  type="text" 
                  id="twitter" 
                  formControlName="twitter"
                  class="flex-1 px-4 py-2 rounded-r-lg bg-gray-700 border border-gray-600 text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
              </div>
            </div>

            <div>
              <label for="github" class="block text-sm font-medium text-gray-300 mb-1">GitHub</label>
              <div class="flex">
                <span class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-600 bg-gray-700 text-gray-400">&#64;</span>
                <input 
                  type="text" 
                  id="github" 
                  formControlName="github"
                  class="flex-1 px-4 py-2 rounded-r-lg bg-gray-700 border border-gray-600 text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
              </div>
            </div>

            <div>
              <label for="linkedin" class="block text-sm font-medium text-gray-300 mb-1">LinkedIn</label>
              <div class="flex">
                <span class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-600 bg-gray-700 text-gray-400">in/</span>
                <input 
                  type="text" 
                  id="linkedin" 
                  formControlName="linkedin"
                  class="flex-1 px-4 py-2 rounded-r-lg bg-gray-700 border border-gray-600 text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
              </div>
            </div>
          </div>
        </div>

        <div class="flex justify-end space-x-3">
          <button 
            type="button" 
            (click)="cancelEdit()"
            class="px-4 py-2 border border-gray-600 rounded-lg text-gray-300 hover:bg-gray-700 transition-colors">
            Cancelar
          </button>
          <button 
            type="submit" 
            [disabled]="profileForm.invalid"
            [ngClass]="{'opacity-50 cursor-not-allowed': profileForm.invalid}"
            class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-white transition-colors">
            Guardar Cambios
          </button>
        </div>
      </form>
    </div>

    <!-- Formulario de cambio de contraseña -->
    <div *ngIf="editMode === 'password'" class="bg-gray-800 rounded-xl shadow-lg border border-gray-700 p-6">
      <form [formGroup]="passwordForm" (ngSubmit)="changePassword()">
        <div class="space-y-6 mb-8">
          <div>
            <label for="currentPassword" class="block text-sm font-medium text-gray-300 mb-1">Contraseña Actual</label>
            <input 
              type="password" 
              id="currentPassword" 
              formControlName="currentPassword"
              class="w-full px-4 py-2 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            <div *ngIf="passwordForm.get('currentPassword')?.invalid && passwordForm.get('currentPassword')?.touched" class="text-red-400 text-sm mt-1">
              <span *ngIf="passwordForm.get('currentPassword')?.errors?.['required']">La contraseña actual es obligatoria</span>
            </div>
          </div>

          <div>
            <label for="newPassword" class="block text-sm font-medium text-gray-300 mb-1">Nueva Contraseña</label>
            <input 
              type="password" 
              id="newPassword" 
              formControlName="newPassword"
              class="w-full px-4 py-2 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            <div *ngIf="passwordForm.get('newPassword')?.invalid && passwordForm.get('newPassword')?.touched" class="text-red-400 text-sm mt-1">
              <span *ngIf="passwordForm.get('newPassword')?.errors?.['required']">La nueva contraseña es obligatoria</span>
              <span *ngIf="passwordForm.get('newPassword')?.errors?.['minlength']">La contraseña debe tener al menos 8 caracteres</span>
              <span *ngIf="passwordForm.get('newPassword')?.errors?.['pattern']">La contraseña debe incluir mayúsculas, minúsculas, números y caracteres especiales</span>
            </div>
          </div>

          <div>
            <label for="confirmPassword" class="block text-sm font-medium text-gray-300 mb-1">Confirmar Contraseña</label>
            <input 
              type="password" 
              id="confirmPassword" 
              formControlName="confirmPassword"
              class="w-full px-4 py-2 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            <div *ngIf="passwordForm.get('confirmPassword')?.invalid && passwordForm.get('confirmPassword')?.touched" class="text-red-400 text-sm mt-1">
              <span *ngIf="passwordForm.get('confirmPassword')?.errors?.['required']">La confirmación de contraseña es obligatoria</span>
            </div>
            <div *ngIf="passwordForm.errors?.['passwordMismatch'] && passwordForm.get('confirmPassword')?.touched" class="text-red-400 text-sm mt-1">
              Las contraseñas no coinciden
            </div>
          </div>
        </div>

        <div class="bg-gray-700/50 p-4 rounded-lg mb-6">
          <h4 class="font-medium text-gray-300 mb-2">Requisitos de contraseña:</h4>
          <ul class="list-disc pl-5 space-y-1 text-sm text-gray-400">
            <li>Mínimo 8 caracteres</li>
            <li>Al menos una letra mayúscula (A-Z)</li>
            <li>Al menos una letra minúscula (a-z)</li>
            <li>Al menos un número (0-9)</li>
            <li>Al menos un caracter especial (ej: &#64;)</li>
          </ul>
        </div>

        <div class="flex justify-end space-x-3">
          <button 
            type="button" 
            (click)="cancelEdit()"
            class="px-4 py-2 border border-gray-600 rounded-lg text-gray-300 hover:bg-gray-700 transition-colors">
            Cancelar
          </button>
          <button 
            type="submit" 
            [disabled]="passwordForm.invalid"
            [ngClass]="{'opacity-50 cursor-not-allowed': passwordForm.invalid}"
            class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-white transition-colors">
            Cambiar Contraseña
          </button>
        </div>
      </form>
    </div>

    <!-- Sección de edición de avatar -->
    <div *ngIf="editMode === 'avatar'" class="bg-gray-800 rounded-xl shadow-lg border border-gray-700 p-6">
      <div class="flex flex-col md:flex-row gap-8 mb-8">
        <div class="md:w-1/3 flex flex-col items-center">
          <div *ngIf="previewAvatar; else placeholderPreview" class="w-40 h-40 rounded-full overflow-hidden border-4 border-gray-700 mb-3">
            <img [src]="previewAvatar" alt="Avatar de usuario" class="w-full h-full object-cover">
          </div>
          <ng-template #placeholderPreview>
            <div class="w-40 h-40 rounded-full bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center border-4 border-gray-700 mb-3">
              <span *ngIf="user" class="text-4xl font-bold text-white">{{ user.fullName.charAt(0) }}</span>
              <span *ngIf="!user" class="text-4xl font-bold text-white">U</span>
            </div>
          </ng-template>
          <h3 class="text-lg font-medium text-gray-200">Vista Previa</h3>
        </div>

        <div class="md:w-2/3">
          <h3 class="text-lg font-medium text-gray-200 mb-4">Actualizar foto de perfil</h3>
          
          <div class="mb-6">
            <label for="avatarUrl" class="block text-sm font-medium text-gray-300 mb-1">URL de imagen</label>
            <input 
              type="url" 
              id="avatarUrl" 
              (change)="onAvatarUrlChange($event)"
              [value]="previewAvatar || ''"
              placeholder="https://ejemplo.com/imagen.jpg"
              class="w-full px-4 py-2 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            <p class="text-sm text-gray-400 mt-1">Ingresa la URL de una imagen para usar como avatar.</p>
          </div>
          
          <div class="bg-gray-700/30 p-4 rounded-lg border border-gray-700 mb-6">
            <h4 class="font-medium text-gray-300 mb-2">Sugerencias para el avatar:</h4>
            <ul class="list-disc pl-5 space-y-1 text-sm text-gray-400">
              <li>Tamaño recomendado: 300x300 píxeles</li>
              <li>Formatos aceptados: JPG, PNG, WebP</li>
              <li>Tamaño máximo: 2MB</li>
            </ul>
          </div>

          <div class="bg-blue-600/20 border border-blue-500/30 p-4 rounded-lg">
            <div class="flex items-start">
              <i class="fa fa-info-circle text-blue-400 mt-1 mr-3"></i>
              <p class="text-blue-300 text-sm">En una implementación completa, aquí sería posible subir imágenes directamente desde tu dispositivo. Por ahora, utiliza URL de imágenes públicas.</p>
            </div>
          </div>
        </div>
      </div>

      <div class="flex justify-end space-x-3">
        <button 
          type="button" 
          (click)="cancelEdit()"
          class="px-4 py-2 border border-gray-600 rounded-lg text-gray-300 hover:bg-gray-700 transition-colors">
          Cancelar
        </button>
        <button 
          type="button" 
          (click)="updateAvatar()"
          [disabled]="!previewAvatar"
          [ngClass]="{'opacity-50 cursor-not-allowed': !previewAvatar}"
          class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-white transition-colors">
          Guardar Avatar
        </button>
      </div>
    </div>
  </div>
</div> 